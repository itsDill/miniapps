<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pomodoro Timer - iowidgets</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }
      .container {
        background: white;
        border-radius: 20px;
        padding: 50px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        text-align: center;
        max-width: 500px;
        width: 100%;
      }
      h1 {
        font-size: 32px;
        margin-bottom: 10px;
        color: #333;
      }
      .mode {
        font-size: 16px;
        color: #666;
        margin-bottom: 30px;
        font-weight: 600;
      }
      .timer-display {
        font-size: 96px;
        font-weight: 700;
        color: #667eea;
        margin: 40px 0;
        font-variant-numeric: tabular-nums;
      }
      .controls {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-bottom: 30px;
      }
      button {
        padding: 16px 32px;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }
      .primary-btn {
        background: #667eea;
        color: white;
      }
      .primary-btn:hover {
        background: #5568d3;
        transform: translateY(-2px);
      }
      .secondary-btn {
        background: #e0e0e0;
        color: #333;
      }
      .secondary-btn:hover {
        background: #d0d0d0;
      }
      .mode-switches {
        display: flex;
        gap: 10px;
        justify-content: center;
      }
      .mode-btn {
        padding: 10px 20px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        background: white;
        color: #666;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
      }
      .mode-btn.active {
        background: #667eea;
        color: white;
        border-color: #667eea;
      }
      .sessions {
        margin-top: 20px;
        font-size: 14px;
        color: #666;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üçÖ Pomodoro Timer</h1>
      <div class="mode" id="modeText">Focus Time</div>
      <div class="timer-display" id="timer">25:00</div>
      <div class="controls">
        <button class="primary-btn" id="startBtn" onclick="toggleTimer()">
          Start
        </button>
        <button class="secondary-btn" onclick="resetTimer()">Reset</button>
      </div>
      <div class="mode-switches">
        <button class="mode-btn active" onclick="setMode('work')">
          Focus (25)
        </button>
        <button class="mode-btn" onclick="setMode('short')">
          Short Break (5)
        </button>
        <button class="mode-btn" onclick="setMode('long')">
          Long Break (15)
        </button>
      </div>
      <div class="sessions">
        Sessions completed: <span id="sessions">0</span>
      </div>
    </div>
    <script>
      let minutes = 25;
      let seconds = 0;
      let isRunning = false;
      let interval;
      let sessions = 0;
      let currentMode = "work";

      const modes = {
        work: { time: 25, label: "Focus Time" },
        short: { time: 5, label: "Short Break" },
        long: { time: 15, label: "Long Break" },
      };

      function setMode(mode) {
        currentMode = mode;
        minutes = modes[mode].time;
        seconds = 0;
        isRunning = false;
        clearInterval(interval);
        updateDisplay();
        document.getElementById("startBtn").textContent = "Start";
        document.getElementById("modeText").textContent = modes[mode].label;
        document.querySelectorAll(".mode-btn").forEach((btn, i) => {
          btn.classList.toggle("active", ["work", "short", "long"][i] === mode);
        });
      }

      function toggleTimer() {
        isRunning = !isRunning;
        const btn = document.getElementById("startBtn");

        if (isRunning) {
          btn.textContent = "Pause";
          interval = setInterval(() => {
            if (seconds === 0) {
              if (minutes === 0) {
                clearInterval(interval);
                isRunning = false;
                btn.textContent = "Start";
                if (currentMode === "work") {
                  sessions++;
                  document.getElementById("sessions").textContent = sessions;
                }
                playSound();
                return;
              }
              minutes--;
              seconds = 59;
            } else {
              seconds--;
            }
            updateDisplay();
          }, 1000);
        } else {
          btn.textContent = "Start";
          clearInterval(interval);
        }
      }

      function resetTimer() {
        isRunning = false;
        clearInterval(interval);
        minutes = modes[currentMode].time;
        seconds = 0;
        updateDisplay();
        document.getElementById("startBtn").textContent = "Start";
      }

      function updateDisplay() {
        const m = String(minutes).padStart(2, "0");
        const s = String(seconds).padStart(2, "0");
        document.getElementById("timer").textContent = `${m}:${s}`;
        document.title = `${m}:${s} - Pomodoro Timer`;
      }

      function playSound() {
        // Simple notification
        if ("Notification" in window && Notification.permission === "granted") {
          new Notification("Pomodoro Timer", {
            body:
              currentMode === "work" ? "Time for a break!" : "Time to focus!",
          });
        }
      }

      // Request notification permission
      if ("Notification" in window && Notification.permission === "default") {
        Notification.requestPermission();
      }
    </script>
  </body>
</html>
