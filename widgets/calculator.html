<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculator Widget - Free Online Calculator | iowidgets</title>

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-S15806B1HW"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-S15806B1HW");
    </script>
    <meta
      name="description"
      content="Free calculator widget with basic and scientific modes. Supports keyboard input, memory functions, calculation history, and themes. Embed on any website instantly."
    />
    <meta
      name="keywords"
      content="calculator, online calculator, scientific calculator, calculator widget, math calculator, free calculator, calculator tool, web calculator"
    />
    <link
      rel="canonical"
      href="https://iowidgets.com/widgets/calculator.html"
    />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://iowidgets.com/widgets/calculator.html"
    />
    <meta
      property="og:title"
      content="Calculator Widget - Free Online Calculator"
    />
    <meta
      property="og:description"
      content="Free calculator widget with basic and scientific modes. Supports keyboard input, memory functions, and calculation history."
    />
    <meta
      property="og:image"
      content="https://iowidgets.com/assets/calculator-preview.jpg"
    />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:url"
      content="https://iowidgets.com/widgets/calculator.html"
    />
    <meta
      name="twitter:title"
      content="Calculator Widget - Free Online Calculator"
    />
    <meta
      name="twitter:description"
      content="Free calculator widget with basic and scientific modes. Supports keyboard input, memory functions, and calculation history."
    />
    <meta
      name="twitter:image"
      content="https://iowidgets.com/assets/calculator-preview.jpg"
    />

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Calculator Widget",
        "url": "https://iowidgets.com/widgets/calculator.html",
        "description": "Free calculator widget with basic and scientific modes",
        "applicationCategory": "UtilityApplication",
        "operatingSystem": "Any",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "featureList": "Basic calculator, Scientific mode, Keyboard support, Memory functions, Calculation history, Multiple themes, Responsive design"
      }
    </script>

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />

    <link rel="stylesheet" href="../assets/shared.css" />
    <style>
      :root {
        --calc-primary: #667eea;
        --calc-secondary: #764ba2;
        --calc-success: #10b981;
        --calc-danger: #ef4444;
        --calc-warning: #f59e0b;
        --text-dark: #333;
        --text-light: #555;
        --border-color: #e0e0e0;
        --shadow-lg: 0 20px 60px rgba(0, 0, 0, 0.3);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
        --transition-speed: 0.3s;
      }

      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      .widget-container {
        max-width: 800px;
        margin: 1rem auto;
        padding: 1rem;
      }

      .widget-preview {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 1.5rem;
      }

      .embed-section {
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .embed-section h2 {
        margin-bottom: 1rem;
        color: #fff;
        font-size: clamp(1.25rem, 3vw, 1.5rem);
      }

      .code-block {
        background: #1e1e1e;
        border-radius: 10px;
        padding: 1rem;
        overflow-x: auto;
        margin: 1rem 0;
        position: relative;
      }

      .code-block pre {
        margin: 0;
        color: #d4d4d4;
        font-family: "Courier New", Consolas, Monaco, monospace;
        font-size: clamp(0.75rem, 2vw, 0.9rem);
        line-height: 1.5;
      }

      .copy-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(99, 102, 241, 0.8);
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.85rem;
        transition: all var(--transition-speed);
        min-height: 44px;
        min-width: 44px;
      }

      .copy-btn:hover {
        background: rgba(99, 102, 241, 1);
        transform: translateY(-2px);
      }

      .copy-btn:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
      }

      .copy-btn.copied {
        background: rgba(34, 197, 94, 0.8);
      }

      .back-btn {
        display: inline-block;
        margin: 1rem 0 2rem;
        padding: 0.75rem 1.5rem;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        text-decoration: none;
        border-radius: 50px;
        transition: all var(--transition-speed);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        min-height: 44px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .back-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
      }

      .back-btn:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
      }

      /* Calculator Widget Styles */
      #calcWidget {
        width: 100%;
        max-width: 360px;
      }

      .controls-panel {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 15px;
        padding: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        max-width: 360px;
        width: 100%;
      }

      .controls-panel h3 {
        color: white;
        margin-bottom: 1rem;
        font-size: 1.25rem;
      }

      .control-group {
        margin-bottom: 1.25rem;
      }

      .control-group label {
        display: block;
        color: rgba(255, 255, 255, 0.9);
        margin-bottom: 0.5rem;
        font-weight: 600;
        font-size: 0.875rem;
      }

      .control-group select,
      .control-group button {
        width: 100%;
        padding: 0.75rem;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        background: rgba(255, 255, 255, 0.1);
        color: white;
        font-size: 0.9375rem;
        cursor: pointer;
        transition: all var(--transition-speed);
        min-height: 44px;
      }

      .control-group select:focus,
      .control-group button:focus {
        outline: none;
        border-color: rgba(255, 255, 255, 0.5);
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
      }

      .control-group button:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      .history-list {
        max-height: 200px;
        overflow-y: auto;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        padding: 0.75rem;
        margin-top: 0.5rem;
      }

      .history-item {
        color: rgba(255, 255, 255, 0.8);
        padding: 0.5rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        font-family: "Courier New", Consolas, Monaco, monospace;
        font-size: 0.875rem;
      }

      .history-item:last-child {
        border-bottom: none;
      }

      .history-empty {
        color: rgba(255, 255, 255, 0.5);
        text-align: center;
        padding: 1rem;
        font-style: italic;
      }

      /* Tablet breakpoint */
      @media (min-width: 640px) {
        .widget-container {
          margin: 2rem auto;
          padding: 2rem;
        }

        .widget-preview {
          padding: 2rem;
        }

        .embed-section {
          padding: 2rem;
        }
      }

      /* Desktop breakpoint */
      @media (min-width: 1024px) {
        .widget-preview {
          flex-wrap: nowrap;
        }
      }

      /* Accessibility - High contrast focus indicators */
      @media (prefers-contrast: high) {
        button:focus,
        select:focus {
          outline: 3px solid currentColor;
          outline-offset: 2px;
        }
      }
    </style>
  </head>
  <body>
    <div class="widget-container">
      <a
        href="../index.html"
        class="back-btn"
        aria-label="Back to iowidgets homepage"
        >‚Üê Back to iowidgets</a
      >

      <h1 style="text-align: center; color: white; margin: 2rem 0">
        üî¢ Calculator Widget
      </h1>

      <!-- Widget Preview -->
      <div
        class="widget-preview"
        role="region"
        aria-label="Calculator preview and controls"
      >
        <div id="calcWidget"></div>

        <!-- Control Panel -->
        <div class="controls-panel">
          <h3>‚öôÔ∏è Options</h3>

          <div class="control-group">
            <label for="calcMode">Calculator Mode</label>
            <select
              id="calcMode"
              onchange="toggleMode()"
              aria-label="Calculator mode"
            >
              <option value="basic">Basic</option>
              <option value="scientific">Scientific</option>
            </select>
          </div>

          <div class="control-group">
            <label for="calcTheme">Theme</label>
            <select
              id="calcTheme"
              onchange="changeTheme()"
              aria-label="Calculator theme"
            >
              <option value="purple">Purple Gradient</option>
              <option value="blue">Blue Gradient</option>
              <option value="green">Green Gradient</option>
              <option value="dark">Dark Mode</option>
              <option value="light">Light Mode</option>
            </select>
          </div>

          <div class="control-group">
            <button
              onclick="clearHistory()"
              aria-label="Clear calculation history"
            >
              üóëÔ∏è Clear History
            </button>
          </div>

          <div class="control-group">
            <label>Calculation History</label>
            <div
              class="history-list"
              id="historyList"
              role="log"
              aria-live="polite"
              aria-label="Calculation history"
            >
              <div class="history-empty">No calculations yet</div>
            </div>
          </div>

          <div
            style="
              color: rgba(255, 255, 255, 0.7);
              font-size: 0.875rem;
              margin-top: 1rem;
              padding: 0.75rem;
              background: rgba(0, 0, 0, 0.2);
              border-radius: 8px;
            "
          >
            <strong>‚å®Ô∏è Keyboard Shortcuts:</strong><br />
            Numbers: 0-9<br />
            Operators: + - * /<br />
            Enter: Calculate<br />
            Escape: Clear<br />
            Backspace: Delete
          </div>
        </div>
      </div>

      <!-- Embed Code Section -->
      <div class="embed-section">
        <h2>üìã Embed This Widget</h2>
        <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem">
          Copy and paste this code into your website:
        </p>

        <div class="code-block">
          <button
            class="copy-btn"
            onclick="copyEmbedCode()"
            aria-label="Copy embed code to clipboard"
          >
            Copy Code
          </button>
          <pre
            id="embedCode"
            tabindex="0"
            role="textbox"
            aria-label="Embed code"
          >
&lt;!-- iowidgets Calculator Widget --&gt;
&lt;div id="iowidgets-calculator"&gt;&lt;/div&gt;
&lt;script&gt;
(function() {
    const widget = document.getElementById('iowidgets-calculator');
    const css = `
        .calc{max-width:300px;background:linear-gradient(135deg,#667eea,#764ba2);
        border-radius:15px;padding:1.5rem;box-shadow:0 10px 40px rgba(0,0,0,0.3);}
        .calc-display{background:#1e1e1e;color:#fff;font-size:2rem;padding:1rem;
        border-radius:10px;text-align:right;margin-bottom:1rem;min-height:60px;}
        .calc-buttons{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;}
        .calc-btn{padding:1rem;background:rgba(255,255,255,0.2);border:none;
        border-radius:10px;color:#fff;font-size:1.2rem;cursor:pointer;
        transition:all 0.2s;}
        .calc-btn:hover{background:rgba(255,255,255,0.3);transform:scale(1.05);}
        .calc-btn.operator{background:rgba(99,102,241,0.6);}
        .calc-btn.equals{background:rgba(34,197,94,0.6);grid-column:span 2;}
    `;
    
    const style = document.createElement('style');
    style.textContent = css;
    document.head.appendChild(style);
    
    let display = '0', prev = '', operator = '', reset = false;
    
    widget.innerHTML = \`
        &lt;div class="calc"&gt;
            &lt;div class="calc-display" id="calc-display"&gt;0&lt;/div&gt;
            &lt;div class="calc-buttons"&gt;
                &lt;button class="calc-btn" onclick="calcClear()"&gt;C&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcDelete()"&gt;‚å´&lt;/button&gt;
                &lt;button class="calc-btn operator" onclick="calcOp('/')"&gt;√∑&lt;/button&gt;
                &lt;button class="calc-btn operator" onclick="calcOp('*')"&gt;√ó&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('7')"&gt;7&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('8')"&gt;8&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('9')"&gt;9&lt;/button&gt;
                &lt;button class="calc-btn operator" onclick="calcOp('-')"&gt;‚àí&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('4')"&gt;4&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('5')"&gt;5&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('6')"&gt;6&lt;/button&gt;
                &lt;button class="calc-btn operator" onclick="calcOp('+')"&gt;+&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('1')"&gt;1&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('2')"&gt;2&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('3')"&gt;3&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('0')"&gt;0&lt;/button&gt;
                &lt;button class="calc-btn" onclick="calcNum('.')"&gt;.&lt;/button&gt;
                &lt;button class="calc-btn equals" onclick="calcEquals()"&gt;=&lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    \`;
    
    const disp = document.getElementById('calc-display');
    window.calcNum = (n) => {
        if(reset){display='0';reset=false;}
        display = display === '0' ? n : display + n;
        disp.textContent = display;
    };
    window.calcOp = (op) => {
        prev = display; operator = op; reset = true;
    };
    window.calcEquals = () => {
        const a = parseFloat(prev), b = parseFloat(display);
        if(operator === '+') display = String(a + b);
        else if(operator === '-') display = String(a - b);
        else if(operator === '*') display = String(a * b);
        else if(operator === '/') display = String(a / b);
        disp.textContent = display;
        reset = true;
    };
    window.calcClear = () => {
        display = '0'; prev = ''; operator = ''; reset = false;
        disp.textContent = display;
    };
    window.calcDelete = () => {
        display = display.length > 1 ? display.slice(0, -1) : '0';
        disp.textContent = display;
    };
})();
&lt;/script&gt;</pre
          >
        </div>

        <p
          style="
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            margin-top: 1rem;
          "
        >
          üí° Fully functional calculator that works anywhere. No dependencies
          required!
        </p>
      </div>
    </div>

    <script>
      // Calculator state
      let display = "0";
      let prev = "";
      let operator = "";
      let reset = false;
      let memory = 0;
      let history = [];
      let currentMode = "basic";
      let currentTheme = "purple";

      // Theme configurations
      const themes = {
        purple: "linear-gradient(135deg,#667eea,#764ba2)",
        blue: "linear-gradient(135deg,#4f46e5,#06b6d4)",
        green: "linear-gradient(135deg,#10b981,#059669)",
        dark: "linear-gradient(135deg,#1e293b,#0f172a)",
        light: "linear-gradient(135deg,#e2e8f0,#cbd5e1)",
      };

      // Initialize calculator in preview
      (function () {
        const widget = document.getElementById("calcWidget");
        const css = `
          .calc{
            max-width:360px;
            width:100%;
            background:linear-gradient(135deg,#667eea,#764ba2);
            border-radius:15px;
            padding:1.5rem;
            box-shadow:0 10px 40px rgba(0,0,0,0.3);
            transition: background 0.3s ease;
          }
          .calc-display{
            background:#1e1e1e;
            color:#fff;
            font-size:clamp(1.5rem, 5vw, 2rem);
            padding:1rem;
            border-radius:10px;
            text-align:right;
            margin-bottom:1rem;
            min-height:60px;
            word-wrap:break-word;
            font-family: "Courier New", Consolas, Monaco, monospace;
            display:flex;
            align-items:center;
            justify-content:flex-end;
          }
          .calc-buttons{
            display:grid;
            grid-template-columns:repeat(4,1fr);
            gap:10px;
          }
          .calc-btn{
            padding:1rem;
            background:rgba(255,255,255,0.2);
            border:none;
            border-radius:10px;
            color:#fff;
            font-size:1.2rem;
            cursor:pointer;
            transition:all 0.2s;
            min-height:44px;
            font-weight:600;
          }
          .calc-btn:hover{
            background:rgba(255,255,255,0.3);
            transform:scale(1.05);
          }
          .calc-btn:focus{
            outline:none;
            box-shadow:0 0 0 3px rgba(255,255,255,0.3);
          }
          .calc-btn:active{
            transform:scale(0.95);
          }
          .calc-btn.operator{
            background:rgba(99,102,241,0.6);
          }
          .calc-btn.equals{
            background:rgba(34,197,94,0.6);
            grid-column:span 2;
          }
          .calc-btn.function{
            background:rgba(245,158,11,0.6);
            font-size:1rem;
          }
          .calc-btn.memory{
            background:rgba(236,72,153,0.6);
            font-size:1rem;
          }
          .scientific-row{
            display:none;
          }
          .scientific-row.active{
            display:contents;
          }
          @media (prefers-reduced-motion: reduce) {
            .calc-btn{
              transition:none;
            }
          }
        `;

        const style = document.createElement("style");
        style.textContent = css;
        style.id = "calc-dynamic-styles";
        document.head.appendChild(style);

        updateCalcHTML();
      })();

      function updateCalcHTML() {
        const widget = document.getElementById("calcWidget");
        const scientificButtons =
          currentMode === "scientific"
            ? `
          <button class="calc-btn function scientific-row active" onclick="calcFunction('sqrt')" aria-label="Square root">‚àö</button>
          <button class="calc-btn function scientific-row active" onclick="calcFunction('square')" aria-label="Square">x¬≤</button>
          <button class="calc-btn function scientific-row active" onclick="calcFunction('percent')" aria-label="Percentage">%</button>
          <button class="calc-btn function scientific-row active" onclick="calcFunction('inverse')" aria-label="Inverse">1/x</button>
          <button class="calc-btn memory scientific-row active" onclick="memoryStore()" aria-label="Memory store">MS</button>
          <button class="calc-btn memory scientific-row active" onclick="memoryRecall()" aria-label="Memory recall">MR</button>
          <button class="calc-btn memory scientific-row active" onclick="memoryClear()" aria-label="Memory clear">MC</button>
          <button class="calc-btn memory scientific-row active" onclick="memoryAdd()" aria-label="Memory add">M+</button>
        `
            : "";

        widget.innerHTML = `
          <div class="calc" id="calc-main">
            <div class="calc-display" id="calc-display" role="status" aria-live="polite" aria-label="Calculator display">0</div>
            <div class="calc-buttons">
              ${scientificButtons}
              <button class="calc-btn" onclick="calcClear()" aria-label="Clear">C</button>
              <button class="calc-btn" onclick="calcDelete()" aria-label="Delete">‚å´</button>
              <button class="calc-btn operator" onclick="calcOp('/')" aria-label="Divide">√∑</button>
              <button class="calc-btn operator" onclick="calcOp('*')" aria-label="Multiply">√ó</button>
              <button class="calc-btn" onclick="calcNum('7')" aria-label="7">7</button>
              <button class="calc-btn" onclick="calcNum('8')" aria-label="8">8</button>
              <button class="calc-btn" onclick="calcNum('9')" aria-label="9">9</button>
              <button class="calc-btn operator" onclick="calcOp('-')" aria-label="Subtract">‚àí</button>
              <button class="calc-btn" onclick="calcNum('4')" aria-label="4">4</button>
              <button class="calc-btn" onclick="calcNum('5')" aria-label="5">5</button>
              <button class="calc-btn" onclick="calcNum('6')" aria-label="6">6</button>
              <button class="calc-btn operator" onclick="calcOp('+')" aria-label="Add">+</button>
              <button class="calc-btn" onclick="calcNum('1')" aria-label="1">1</button>
              <button class="calc-btn" onclick="calcNum('2')" aria-label="2">2</button>
              <button class="calc-btn" onclick="calcNum('3')" aria-label="3">3</button>
              <button class="calc-btn" onclick="calcNum('0')" aria-label="0">0</button>
              <button class="calc-btn" onclick="calcNum('.')" aria-label="Decimal point">.</button>
              <button class="calc-btn equals" onclick="calcEquals()" aria-label="Equals">=</button>
            </div>
          </div>
        `;

        const disp = document.getElementById("calc-display");
        disp.textContent = display;

        // Setup keyboard support
        setupKeyboardSupport();
      }

      function setupKeyboardSupport() {
        document.addEventListener("keydown", handleKeyboard);
      }

      function handleKeyboard(e) {
        if (e.target.tagName === "INPUT" || e.target.tagName === "SELECT")
          return;

        if (e.key >= "0" && e.key <= "9") {
          e.preventDefault();
          calcNum(e.key);
        } else if (e.key === ".") {
          e.preventDefault();
          calcNum(".");
        } else if (
          e.key === "+" ||
          e.key === "-" ||
          e.key === "*" ||
          e.key === "/"
        ) {
          e.preventDefault();
          calcOp(e.key);
        } else if (e.key === "Enter" || e.key === "=") {
          e.preventDefault();
          calcEquals();
        } else if (e.key === "Escape") {
          e.preventDefault();
          calcClear();
        } else if (e.key === "Backspace") {
          e.preventDefault();
          calcDelete();
        }
      }

      window.calcNum = (n) => {
        if (reset) {
          display = "0";
          reset = false;
        }
        if (n === "." && display.includes(".")) return;
        display = display === "0" && n !== "." ? n : display + n;
        updateDisplay();
      };

      window.calcOp = (op) => {
        if (prev && operator && !reset) {
          calcEquals();
        }
        prev = display;
        operator = op;
        reset = true;
      };

      window.calcEquals = () => {
        if (!prev || !operator) return;

        const a = parseFloat(prev);
        const b = parseFloat(display);
        let result;
        let equation;

        if (operator === "+") {
          result = a + b;
          equation = `${a} + ${b} = ${result}`;
        } else if (operator === "-") {
          result = a - b;
          equation = `${a} ‚àí ${b} = ${result}`;
        } else if (operator === "*") {
          result = a * b;
          equation = `${a} √ó ${b} = ${result}`;
        } else if (operator === "/") {
          if (b === 0) {
            display = "Error";
            updateDisplay();
            reset = true;
            return;
          }
          result = a / b;
          equation = `${a} √∑ ${b} = ${result}`;
        }

        display = String(result);
        addToHistory(equation);
        updateDisplay();
        reset = true;
        operator = "";
        prev = "";
      };

      window.calcClear = () => {
        display = "0";
        prev = "";
        operator = "";
        reset = false;
        updateDisplay();
      };

      window.calcDelete = () => {
        display = display.length > 1 ? display.slice(0, -1) : "0";
        updateDisplay();
      };

      window.calcFunction = (func) => {
        const num = parseFloat(display);
        let result;
        let equation;

        switch (func) {
          case "sqrt":
            if (num < 0) {
              display = "Error";
              updateDisplay();
              return;
            }
            result = Math.sqrt(num);
            equation = `‚àö${num} = ${result}`;
            break;
          case "square":
            result = num * num;
            equation = `${num}¬≤ = ${result}`;
            break;
          case "percent":
            result = num / 100;
            equation = `${num}% = ${result}`;
            break;
          case "inverse":
            if (num === 0) {
              display = "Error";
              updateDisplay();
              return;
            }
            result = 1 / num;
            equation = `1/${num} = ${result}`;
            break;
        }

        display = String(result);
        addToHistory(equation);
        updateDisplay();
        reset = true;
      };

      window.memoryStore = () => {
        memory = parseFloat(display);
        addToHistory(`Memory: ${memory}`);
      };

      window.memoryRecall = () => {
        display = String(memory);
        updateDisplay();
        reset = true;
      };

      window.memoryClear = () => {
        memory = 0;
        addToHistory("Memory cleared");
      };

      window.memoryAdd = () => {
        memory += parseFloat(display);
        addToHistory(`Memory: ${memory}`);
      };

      function updateDisplay() {
        const disp = document.getElementById("calc-display");
        if (disp) {
          disp.textContent = display;
        }
      }

      function addToHistory(entry) {
        history.unshift(entry);
        if (history.length > 10) history.pop();
        updateHistoryDisplay();
      }

      function updateHistoryDisplay() {
        const historyList = document.getElementById("historyList");
        if (!historyList) return;

        if (history.length === 0) {
          historyList.innerHTML =
            '<div class="history-empty">No calculations yet</div>';
        } else {
          historyList.innerHTML = history
            .map((item) => `<div class="history-item">${item}</div>`)
            .join("");
        }
      }

      window.clearHistory = () => {
        history = [];
        updateHistoryDisplay();
      };

      window.toggleMode = () => {
        const mode = document.getElementById("calcMode").value;
        currentMode = mode;
        updateCalcHTML();
      };

      window.changeTheme = () => {
        const theme = document.getElementById("calcTheme").value;
        currentTheme = theme;
        const calcMain = document.getElementById("calc-main");
        if (calcMain) {
          calcMain.style.background = themes[theme];
        }
      };

      function copyEmbedCode() {
        const code = document.getElementById("embedCode").textContent;
        navigator.clipboard
          .writeText(code)
          .then(() => {
            const btn = document.querySelector(".copy-btn");
            btn.textContent = "‚úì Copied!";
            btn.classList.add("copied");

            setTimeout(() => {
              btn.textContent = "Copy Code";
              btn.classList.remove("copied");
            }, 2000);
          })
          .catch((err) => {
            console.error("Failed to copy:", err);
            const btn = document.querySelector(".copy-btn");
            btn.textContent = "‚úó Failed";
            setTimeout(() => {
              btn.textContent = "Copy Code";
            }, 2000);
          });
      }
    </script>
  </body>
</html>
