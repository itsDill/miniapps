<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Typing Speed Test - iowidgets</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }
      .container {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 800px;
        width: 100%;
      }
      h1 {
        font-size: 32px;
        margin-bottom: 20px;
        color: #333;
        text-align: center;
      }
      .timer {
        text-align: center;
        font-size: 24px;
        font-weight: 700;
        color: #4facfe;
        margin-bottom: 20px;
      }
      .text-display {
        background: #f8f9fa;
        padding: 30px;
        border-radius: 12px;
        font-size: 20px;
        line-height: 1.8;
        margin-bottom: 20px;
        min-height: 150px;
        user-select: none;
      }
      .text-display span {
        position: relative;
      }
      .text-display .correct {
        color: #10b981;
      }
      .text-display .incorrect {
        color: #ef4444;
        background: #fee;
      }
      .text-display .current {
        border-left: 3px solid #4facfe;
        animation: blink 1s infinite;
      }
      @keyframes blink {
        50% {
          border-color: transparent;
        }
      }
      .input-area {
        margin-bottom: 20px;
      }
      textarea {
        width: 100%;
        padding: 16px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 18px;
        font-family: inherit;
        resize: none;
        height: 100px;
      }
      textarea:focus {
        outline: none;
        border-color: #4facfe;
      }
      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
      }
      .stat-card {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
      }
      .stat-value {
        font-size: 32px;
        font-weight: 700;
        color: #4facfe;
      }
      .stat-label {
        font-size: 14px;
        color: #666;
        margin-top: 5px;
      }
      button {
        width: 100%;
        padding: 16px;
        background: #4facfe;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 20px;
      }
      button:hover {
        background: #3b9ae1;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>⌨️ Typing Speed Test</h1>
      <div class="timer" id="timer">60s</div>
      <div class="text-display" id="textDisplay"></div>
      <div class="input-area">
        <textarea
          id="inputArea"
          placeholder="Click here and start typing..."
          oninput="checkInput()"
          disabled
        ></textarea>
      </div>
      <div class="stats">
        <div class="stat-card">
          <div class="stat-value" id="wpm">0</div>
          <div class="stat-label">WPM</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="accuracy">100</div>
          <div class="stat-label">% Accuracy</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="errors">0</div>
          <div class="stat-label">Errors</div>
        </div>
      </div>
      <button onclick="startTest()">Start Test</button>
    </div>
    <script>
      const texts = [
        "The quick brown fox jumps over the lazy dog near the riverbank.",
        "Programming is the art of telling another human what one wants the computer to do.",
        "Practice makes perfect, but nobody is perfect, so why practice?",
        "Type with precision and speed to master the keyboard effectively.",
      ];

      let testText = "";
      let currentIndex = 0;
      let startTime = 0;
      let timeLeft = 60;
      let interval;
      let errors = 0;

      function startTest() {
        testText = texts[Math.floor(Math.random() * texts.length)];
        currentIndex = 0;
        errors = 0;
        timeLeft = 60;
        startTime = Date.now();

        document.getElementById("inputArea").value = "";
        document.getElementById("inputArea").disabled = false;
        document.getElementById("inputArea").focus();
        displayText();

        interval = setInterval(() => {
          timeLeft--;
          document.getElementById("timer").textContent = timeLeft + "s";
          if (timeLeft === 0) {
            endTest();
          }
        }, 1000);
      }

      function displayText() {
        const display = document.getElementById("textDisplay");
        display.innerHTML = testText
          .split("")
          .map((char, i) => {
            let className = "";
            if (i < currentIndex) {
              className =
                document.getElementById("inputArea").value[i] === char
                  ? "correct"
                  : "incorrect";
            } else if (i === currentIndex) {
              className = "current";
            }
            return `<span class="${className}">${char}</span>`;
          })
          .join("");
      }

      function checkInput() {
        const input = document.getElementById("inputArea").value;
        currentIndex = input.length;

        errors = 0;
        for (let i = 0; i < input.length; i++) {
          if (input[i] !== testText[i]) errors++;
        }

        displayText();
        updateStats();

        if (input.length === testText.length) {
          endTest();
        }
      }

      function updateStats() {
        const elapsed = (Date.now() - startTime) / 1000 / 60;
        const words = document
          .getElementById("inputArea")
          .value.trim()
          .split(/\s+/).length;
        const wpm = Math.round(words / elapsed) || 0;
        const accuracy =
          currentIndex > 0
            ? Math.round(((currentIndex - errors) / currentIndex) * 100)
            : 100;

        document.getElementById("wpm").textContent = wpm;
        document.getElementById("accuracy").textContent = accuracy;
        document.getElementById("errors").textContent = errors;
      }

      function endTest() {
        clearInterval(interval);
        document.getElementById("inputArea").disabled = true;
        updateStats();
      }
    </script>
  </body>
</html>
