<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reaction Time Test - iowidgets</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }
      .container {
        background: white;
        border-radius: 20px;
        padding: 50px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        text-align: center;
        max-width: 600px;
        width: 100%;
      }
      h1 {
        font-size: 32px;
        margin-bottom: 20px;
        color: #333;
      }
      .instruction {
        font-size: 18px;
        color: #666;
        margin-bottom: 30px;
        line-height: 1.6;
      }
      .game-area {
        width: 100%;
        height: 300px;
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 30px;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 24px;
        font-weight: 600;
      }
      .game-area.waiting {
        background: #ef4444;
        color: white;
      }
      .game-area.ready {
        background: #f59e0b;
        color: white;
      }
      .game-area.go {
        background: #10b981;
        color: white;
      }
      .result {
        font-size: 48px;
        font-weight: 700;
        color: #667eea;
        margin-bottom: 20px;
      }
      .average {
        font-size: 18px;
        color: #666;
        margin-bottom: 30px;
      }
      button {
        padding: 16px 32px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }
      button:hover {
        background: #5568d3;
        transform: translateY(-2px);
      }
      .attempts {
        margin-top: 30px;
        display: flex;
        gap: 10px;
        justify-content: center;
        flex-wrap: wrap;
      }
      .attempt {
        padding: 8px 16px;
        background: #f8f9fa;
        border-radius: 8px;
        font-weight: 600;
        color: #666;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>âš¡ Reaction Time Test</h1>
      <div class="instruction" id="instruction">Click START to begin</div>
      <div
        class="game-area waiting"
        id="gameArea"
        onclick="handleClick()"
        style="display: none"
      >
        <span id="gameText">Wait for GREEN...</span>
      </div>
      <div class="result" id="result"></div>
      <div class="average" id="average"></div>
      <button onclick="startGame()" id="startBtn">Start</button>
      <div class="attempts" id="attempts"></div>
    </div>
    <script>
      let state = "idle"; // idle, waiting, ready, clicked
      let startTime = 0;
      let timeout;
      let attempts = [];

      function startGame() {
        state = "waiting";
        document.getElementById("startBtn").style.display = "none";
        document.getElementById("gameArea").style.display = "flex";
        document.getElementById("instruction").textContent = "Wait for it...";
        document.getElementById("result").textContent = "";
        document.getElementById("gameArea").className = "game-area waiting";
        document.getElementById("gameText").textContent = "Wait for GREEN...";

        const delay = 2000 + Math.random() * 3000;
        timeout = setTimeout(() => {
          state = "ready";
          startTime = Date.now();
          document.getElementById("gameArea").className = "game-area go";
          document.getElementById("gameText").textContent = "CLICK NOW!";
          document.getElementById("instruction").textContent =
            "Click as fast as you can!";
        }, delay);
      }

      function handleClick() {
        if (state === "waiting") {
          // Clicked too early
          clearTimeout(timeout);
          resetGame();
          document.getElementById("result").textContent = "Too early!";
          document.getElementById("result").style.color = "#ef4444";
          document.getElementById("instruction").textContent =
            "Wait for the green box!";
        } else if (state === "ready") {
          // Good click
          const reactionTime = Date.now() - startTime;
          attempts.push(reactionTime);

          document.getElementById("result").textContent = reactionTime + " ms";
          document.getElementById("result").style.color = "#10b981";

          if (attempts.length > 0) {
            const avg = Math.round(
              attempts.reduce((a, b) => a + b) / attempts.length
            );
            document.getElementById(
              "average"
            ).textContent = `Average: ${avg} ms (${attempts.length} attempts)`;
          }

          const attemptDiv = document.createElement("div");
          attemptDiv.className = "attempt";
          attemptDiv.textContent = reactionTime + " ms";
          document.getElementById("attempts").appendChild(attemptDiv);

          resetGame();
          document.getElementById("instruction").textContent =
            "Click START to try again";
        }
      }

      function resetGame() {
        state = "idle";
        document.getElementById("gameArea").style.display = "none";
        document.getElementById("startBtn").style.display = "inline-block";
      }
    </script>
  </body>
</html>
