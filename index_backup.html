<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MiniApps - Your Collection of Useful Tools</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        background-attachment: fixed;
        min-height: 100vh;
        overflow-x: hidden;
        color: #fff;
        position: relative;
        transition: all 0.6s ease;
      }

      body.fun-mode {
        background: linear-gradient(
          135deg,
          #ff6b6b 0%,
          #4ecdc4 50%,
          #45b7d1 100%
        );
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>')
          repeat;
        pointer-events: none;
        z-index: 1;
      }

      .bg-pattern {
        position: fixed;
        width: 200px;
        height: 200px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 50%;
        pointer-events: none;
        z-index: 0;
      }

      .bg-pattern:nth-child(1) {
        top: 10%;
        left: 10%;
        animation: slowFloat 20s ease-in-out infinite;
      }

      .bg-pattern:nth-child(2) {
        top: 60%;
        right: 10%;
        animation: slowFloat 25s ease-in-out infinite reverse;
      }

      .bg-pattern:nth-child(3) {
        bottom: 20%;
        left: 20%;
        animation: slowFloat 30s ease-in-out infinite;
      }

      /* Work/Fun Toggle Corners */
      .corner-toggle {
        position: fixed;
        width: 120px;
        height: 120px;
        cursor: pointer;
        z-index: 1000;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        font-size: 0.9rem;
        font-weight: 600;
        text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.3);
      }

      .corner-toggle.work {
        top: 0;
        left: 0;
        background: rgba(74, 144, 226, 0.2);
        backdrop-filter: blur(20px);
        border-bottom-right-radius: 60px;
        border: 3px solid rgba(74, 144, 226, 0.4);
        border-top: none;
        border-left: none;
        transform: translate(-30px, -30px);
      }

      .corner-toggle.fun {
        top: 0;
        right: 0;
        background: rgba(255, 107, 107, 0.2);
        backdrop-filter: blur(20px);
        border-bottom-left-radius: 60px;
        border: 3px solid rgba(255, 107, 107, 0.4);
        border-top: none;
        border-right: none;
        transform: translate(30px, -30px);
      }

      .corner-toggle:hover {
        transform: translate(0, 0);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      .corner-toggle.work:hover {
        background: rgba(74, 144, 226, 0.4);
        border-color: rgba(74, 144, 226, 0.7);
      }

      .corner-toggle.fun:hover {
        background: rgba(255, 107, 107, 0.4);
        border-color: rgba(255, 107, 107, 0.7);
      }

      .corner-toggle.active {
        transform: translate(0, 0);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
      }

      .corner-toggle.work.active {
        background: rgba(74, 144, 226, 0.6);
        border-color: rgba(74, 144, 226, 0.8);
      }

      .corner-toggle.fun.active {
        background: rgba(255, 107, 107, 0.6);
        border-color: rgba(255, 107, 107, 0.8);
      }

      .corner-icon {
        font-size: 2rem;
        margin-bottom: 0.5rem;
      }

      .corner-label {
        font-size: 0.8rem;
        opacity: 0.9;
      }

      @keyframes slowFloat {
        0%,
        100% {
          transform: translateY(0px) translateX(0px);
        }
        25% {
          transform: translateY(-50px) translateX(30px);
        }
        50% {
          transform: translateY(-20px) translateX(-30px);
        }
        75% {
          transform: translateY(-40px) translateX(20px);
        }
      }

      .header {
        text-align: center;
        padding: 3rem 2rem 1rem;
        position: relative;
        z-index: 10;
      }

      .header h1 {
        font-size: 3.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        text-shadow: 2px 2px 20px rgba(0, 0, 0, 0.3);
        letter-spacing: -1px;
        background: linear-gradient(45deg, #fff, #e0e7ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .header p {
        font-size: 1.2rem;
        opacity: 0.9;
        font-weight: 300;
        margin-bottom: 1rem;
      }

      .header-actions {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 1rem;
        flex-wrap: wrap;
      }

      .action-btn {
        padding: 0.75rem 1.5rem;
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(15px);
        border-radius: 50px;
        color: white;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 500;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .action-btn:hover {
        background: rgba(255, 255, 255, 0.25);
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      }

      .action-btn.primary {
        background: rgba(34, 197, 94, 0.3);
        border-color: rgba(34, 197, 94, 0.5);
      }

      .action-btn.primary:hover {
        background: rgba(34, 197, 94, 0.5);
      }

      .filter-container {
        display: flex;
        justify-content: center;
        gap: 0.75rem;
        padding: 1rem 2rem 2rem;
        flex-wrap: wrap;
        position: relative;
        z-index: 10;
        max-width: 1200px;
        margin: 0 auto;
      }

      .search-container {
        display: flex;
        justify-content: center;
        padding: 0 2rem 1rem;
        position: relative;
        z-index: 10;
      }

      .search-box {
        width: 100%;
        max-width: 400px;
        padding: 1rem 1.5rem 1rem 3rem;
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(15px);
        border-radius: 50px;
        color: white;
        font-size: 1rem;
        outline: none;
        transition: all 0.3s ease;
        position: relative;
      }

      .search-box::placeholder {
        color: rgba(255, 255, 255, 0.7);
      }

      .search-box:focus {
        border-color: rgba(74, 144, 226, 0.8);
        background: rgba(74, 144, 226, 0.15);
        box-shadow: 0 0 20px rgba(74, 144, 226, 0.3);
      }

      .search-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(255, 255, 255, 0.6);
        font-size: 1.2rem;
        pointer-events: none;
      }

      .filter-btn {
        padding: 0.6rem 1.2rem;
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(10px);
        border-radius: 50px;
        color: white;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 500;
        white-space: nowrap;
      }

      .filter-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      }

      .filter-btn.active {
        background: rgba(255, 255, 255, 0.95);
        color: #667eea;
        border-color: rgba(255, 255, 255, 0.95);
      }

      .apps-container {
        position: relative;
        width: 100%;
        min-height: calc(100vh - 350px);
        padding: 2rem;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .apps-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 2rem;
        max-width: 1200px;
        width: 100%;
        position: relative;
      }

      .app-bubble {
        width: 160px;
        height: 160px;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(20px);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        position: relative;
        justify-self: center;
        opacity: 0;
        transform: translateY(30px) scale(0.9);
        overflow: hidden;
      }

      .app-bubble::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .app-bubble:hover::before {
        left: 100%;
      }

      .app-bubble.has-image {
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
      }

      .app-bubble.has-image::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(1px);
        border-radius: 28px;
      }

      .app-bubble.has-image .app-icon,
      .app-bubble.has-image .app-name {
        position: relative;
        z-index: 2;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      }

      .app-bubble.visible {
        opacity: 1;
        transform: translateY(0) scale(1);
      }

      .app-bubble:hover {
        background: rgba(255, 255, 255, 0.25);
        transform: translateY(-12px) scale(1.08);
        box-shadow: 0 25px 70px rgba(0, 0, 0, 0.3);
        border-color: rgba(255, 255, 255, 0.6);
      }

      .app-bubble:active {
        transform: translateY(-8px) scale(1.02);
      }

      .app-bubble.custom {
        border-style: dashed;
        border-color: rgba(34, 197, 94, 0.6);
        background: rgba(34, 197, 94, 0.1);
      }

      .app-actions {
        position: absolute;
        top: 8px;
        right: 8px;
        display: flex;
        gap: 4px;
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 3;
      }

      .app-bubble:hover .app-actions {
        opacity: 1;
      }

      .app-action-btn {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.6);
        color: white;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        transition: all 0.2s ease;
        backdrop-filter: blur(10px);
      }

      .app-action-btn:hover {
        background: rgba(0, 0, 0, 0.8);
        transform: scale(1.1);
      }

      .app-action-btn.edit {
        background: rgba(74, 144, 226, 0.8);
      }

      .app-action-btn.delete {
        background: rgba(239, 68, 68, 0.8);
      }

      .app-action-btn.favorite {
        background: rgba(251, 191, 36, 0.8);
      }

      .app-action-btn.favorite.active {
        background: rgba(251, 191, 36, 1);
        transform: scale(1.1);
      }

      .favorites-indicator {
        position: absolute;
        top: -5px;
        right: -5px;
        width: 20px;
        height: 20px;
        background: linear-gradient(45deg, #fbbf24, #f59e0b);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        z-index: 4;
        opacity: 0;
        transform: scale(0);
        transition: all 0.3s ease;
      }

      .app-bubble.favorited .favorites-indicator {
        opacity: 1;
        transform: scale(1);
      }

      .favorites-view-active {
        background: rgba(251, 191, 36, 0.3) !important;
        border-color: rgba(251, 191, 36, 0.6) !important;
      }

      .app-bubble.category-business {
        border-color: rgba(34, 197, 94, 0.6);
        background: rgba(34, 197, 94, 0.1);
      }

      .app-bubble.category-technology {
        border-color: rgba(139, 69, 193, 0.6);
        background: rgba(139, 69, 193, 0.1);
      }

      .app-bubble.category-wellness {
        border-color: rgba(236, 72, 153, 0.6);
        background: rgba(236, 72, 153, 0.1);
      }

      .app-bubble.category-operations {
        border-color: rgba(59, 130, 246, 0.6);
        background: rgba(59, 130, 246, 0.1);
      }

      .app-bubble.category-general {
        border-color: rgba(34, 197, 94, 0.6);
        background: rgba(34, 197, 94, 0.1);
      }

      .app-icon {
        font-size: 3rem;
        margin-bottom: 0.5rem;
      }

      .app-name {
        font-size: 0.9rem;
        font-weight: 600;
        text-align: center;
        padding: 0 0.5rem;
      }

      @keyframes gentleFloat {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        50% {
          transform: translateY(-8px) rotate(1deg);
        }
      }

      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(30px) scale(0.9);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .category-indicator {
        position: absolute;
        top: 8px;
        right: 8px;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        opacity: 0.7;
      }

      .category-indicator.business {
        background: #22c55e;
      }

      .category-indicator.technology {
        background: #8b45c1;
      }

      .category-indicator.wellness {
        background: #ec4899;
      }

      .category-indicator.operations {
        background: #3b82f6;
      }

      .category-indicator.general {
        background: #22c55e;
      }

      /* Modal Styles */
      .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        backdrop-filter: blur(10px);
      }

      .modal-content {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(30px);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 25px;
        padding: 2rem;
        max-width: 500px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        position: relative;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
      }

      .modal-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: white;
      }

      .close-btn {
        background: none;
        border: none;
        color: white;
        font-size: 2rem;
        cursor: pointer;
        padding: 0;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s ease;
      }

      .close-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: white;
      }

      .form-input {
        width: 100%;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 15px;
        color: white;
        font-size: 1rem;
        outline: none;
        transition: all 0.3s ease;
      }

      .form-input:focus {
        border-color: rgba(74, 144, 226, 0.8);
        background: rgba(74, 144, 226, 0.15);
        box-shadow: 0 0 20px rgba(74, 144, 226, 0.3);
      }

      .form-input::placeholder {
        color: rgba(255, 255, 255, 0.6);
      }

      .form-select {
        width: 100%;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 15px;
        color: white;
        font-size: 1rem;
        outline: none;
        cursor: pointer;
      }

      .emoji-grid {
        display: grid;
        grid-template-columns: repeat(8, 1fr);
        gap: 0.5rem;
        max-height: 200px;
        overflow-y: auto;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
      }

      .emoji-btn {
        padding: 0.75rem;
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid transparent;
        border-radius: 10px;
        cursor: pointer;
        font-size: 1.5rem;
        transition: all 0.2s ease;
      }

      .emoji-btn:hover,
      .emoji-btn.selected {
        background: rgba(255, 255, 255, 0.3);
        border-color: rgba(74, 144, 226, 0.8);
        transform: scale(1.1);
      }

      .image-upload {
        border: 2px dashed rgba(255, 255, 255, 0.3);
        border-radius: 15px;
        padding: 2rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .image-upload:hover {
        border-color: rgba(74, 144, 226, 0.8);
        background: rgba(74, 144, 226, 0.1);
      }

      .image-upload.dragover {
        border-color: rgba(34, 197, 94, 0.8);
        background: rgba(34, 197, 94, 0.1);
      }

      .image-preview {
        width: 80px;
        height: 80px;
        border-radius: 15px;
        object-fit: cover;
        margin: 0 auto 1rem;
        display: none;
      }

      .btn-group {
        display: flex;
        gap: 1rem;
        margin-top: 2rem;
      }

      .btn {
        flex: 1;
        padding: 1rem 1.5rem;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 15px;
        background: rgba(255, 255, 255, 0.2);
        color: white;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
      }

      .btn.primary {
        background: rgba(34, 197, 94, 0.3);
        border-color: rgba(34, 197, 94, 0.5);
      }

      .btn.primary:hover {
        background: rgba(34, 197, 94, 0.5);
      }

      .notification {
        position: fixed;
        top: 2rem;
        right: 2rem;
        padding: 1rem 1.5rem;
        background: rgba(34, 197, 94, 0.9);
        color: white;
        border-radius: 15px;
        font-weight: 600;
        z-index: 1100;
        transform: translateX(100%);
        transition: transform 0.3s ease;
        backdrop-filter: blur(20px);
      }

      .notification.show {
        transform: translateX(0);
      }

      .notification.error {
        background: rgba(239, 68, 68, 0.9);
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 2.5rem;
        }

        .filter-container {
          gap: 0.5rem;
        }

        .filter-btn {
          padding: 0.5rem 1rem;
          font-size: 0.8rem;
        }

        .apps-container {
          padding: 1rem;
        }

        .apps-grid {
          grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
          gap: 1.5rem;
        }

        .app-bubble {
          width: 140px;
          height: 140px;
        }

        .app-icon {
          font-size: 2.5rem;
        }
      }

      @media (max-width: 480px) {
        .filter-container {
          gap: 0.4rem;
          padding: 0.5rem 1rem 2rem;
        }

        .filter-btn {
          padding: 0.4rem 0.8rem;
          font-size: 0.75rem;
        }

        .apps-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 1rem;
        }

        .app-bubble {
          width: 120px;
          height: 120px;
        }

        .app-icon {
          font-size: 2rem;
        }

        .app-name {
          font-size: 0.8rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="bg-pattern"></div>
    <div class="bg-pattern"></div>
    <div class="bg-pattern"></div>

    <!-- Work/Fun Toggle Corners -->
    <div
      class="corner-toggle work active"
      id="workToggle"
      onclick="toggleMode('work')"
    >
      <div class="corner-icon">üíº</div>
      <div class="corner-label">WORK</div>
    </div>
    <div class="corner-toggle fun" id="funToggle" onclick="toggleMode('fun')">
      <div class="corner-icon">üéÆ</div>
      <div class="corner-label">FUN</div>
    </div>

    <div class="header">
      <h1>MiniApps</h1>
      <p>Industry-specific tools for professionals</p>
      <small style="opacity: 0.8; font-size: 0.9rem"
        >‚òÖ Favorite apps and create your personalized collection</small
      >
      <div class="header-actions">
        <button
          class="action-btn primary"
          id="favoritesToggle"
          onclick="toggleFavoritesView()"
        >
          ‚≠ê My Favorites
        </button>
      </div>
    </div>

    <div class="search-container">
      <div style="position: relative; width: 100%; max-width: 400px">
        <span class="search-icon">üîç</span>
        <input
          type="text"
          class="search-box"
          id="searchBox"
          placeholder="Search apps..."
        />
      </div>
    </div>

    <div class="filter-container">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="business">ÔøΩ Business</button>
      <button class="filter-btn" data-filter="technology">üíª Tech & Design</button>
      <button class="filter-btn" data-filter="wellness">ÔøΩ Health & Learning</button>
      <button class="filter-btn" data-filter="operations">‚ö° Operations</button>
    </div>

    <div class="apps-container" id="appsContainer">
      <div class="apps-grid" id="appsGrid"></div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
      const defaultApps = [
        // BUSINESS CATEGORY - Financial & Business Tools
        {
          id: "expense-tracker",
          name: "Expense Tracker",
          icon: "üí∞",
          category: "business",
          url: "#",
          builtin: true,
        },
        {
          id: "roi-calc",
          name: "ROI Calculator",
          icon: "üìä",
          category: "finance",
          url: "#",
          builtin: true,
        },
        {
          id: "budget-planner",
          name: "Budget Planner",
          icon: "üí≥",
          category: "finance",
          url: "#",
          builtin: true,
        },
        {
          id: "currency-converter",
          name: "Currency Convert",
          icon: "üí±",
          category: "finance",
          url: "#",
          builtin: true,
        },
        {
          id: "loan-calc",
          name: "Loan Calculator",
          icon: "üè¶",
          category: "finance",
          url: "#",
          builtin: true,
        },

        // Technology Industry Apps
        {
          id: "code-formatter",
          name: "Code Formatter",
          icon: "ÔøΩ",
          category: "technology",
          url: "#",
          builtin: true,
        },
        {
          id: "api-tester",
          name: "API Tester",
          icon: "ÔøΩ",
          category: "technology",
          url: "#",
          builtin: true,
        },
        {
          id: "regex-builder",
          name: "Regex Builder",
          icon: "ÔøΩ",
          category: "technology",
          url: "#",
          builtin: true,
        },
        {
          id: "json-formatter",
          name: "JSON Formatter",
          icon: "ÔøΩ",
          category: "technology",
          url: "#",
          builtin: true,
        },
        {
          id: "hash-generator",
          name: "Hash Generator",
          icon: "ÔøΩ",
          category: "technology",
          url: "#",
          builtin: true,
        },

        // Education Industry Apps
        {
          id: "grade-calc",
          name: "Grade Calculator",
          icon: "üìä",
          category: "education",
          url: "#",
          builtin: true,
        },
        {
          id: "quiz-maker",
          name: "Quiz Maker",
          icon: "‚ùì",
          category: "education",
          url: "#",
          builtin: true,
        },
        {
          id: "flashcards",
          name: "Flashcards",
          icon: "üìö",
          category: "education",
          url: "#",
          builtin: true,
        },
        {
          id: "class-schedule",
          name: "Class Schedule",
          icon: "üìÖ",
          category: "education",
          url: "#",
          builtin: true,
        },
        {
          id: "student-tracker",
          name: "Student Tracker",
          icon: "üë®‚Äçüéì",
          category: "education",
          url: "#",
          builtin: true,
        },

        // Construction Industry Apps
        {
          id: "material-calc",
          name: "Material Calc",
          icon: "üß±",
          category: "construction",
          url: "#",
          builtin: true,
        },
        {
          id: "project-progress",
          name: "Project Progress",
          icon: "üìà",
          category: "construction",
          url: "#",
          builtin: true,
        },
        {
          id: "safety-checklist",
          name: "Safety Checklist",
          icon: "‚ö†Ô∏è",
          category: "construction",
          url: "#",
          builtin: true,
        },
        {
          id: "tool-inventory",
          name: "Tool Inventory",
          icon: "üîß",
          category: "construction",
          url: "#",
          builtin: true,
        },
        {
          id: "cost-estimator",
          name: "Cost Estimator",
          icon: "üíµ",
          category: "construction",
          url: "#",
          builtin: true,
        },

        // Transport Industry Apps
        {
          id: "route-planner",
          name: "Route Planner",
          icon: "üó∫Ô∏è",
          category: "transport",
          url: "#",
          builtin: true,
        },
        {
          id: "fuel-tracker",
          name: "Fuel Tracker",
          icon: "‚õΩ",
          category: "transport",
          url: "#",
          builtin: true,
        },
        {
          id: "delivery-log",
          name: "Delivery Log",
          icon: "üì¶",
          category: "transport",
          url: "#",
          builtin: true,
        },
        {
          id: "vehicle-maintenance",
          name: "Vehicle Maintenance",
          icon: "üîß",
          category: "transport",
          url: "#",
          builtin: true,
        },
        {
          id: "driver-hours",
          name: "Driver Hours",
          icon: "üöõ",
          category: "transport",
          url: "#",
          builtin: true,
        },

        // Healthcare Industry Apps
        {
          id: "patient-tracker",
          name: "Patient Tracker",
          icon: "üè•",
          category: "healthcare",
          url: "#",
          builtin: true,
        },
        {
          id: "medication-reminder",
          name: "Med Reminder",
          icon: "ÔøΩ",
          category: "healthcare",
          url: "#",
          builtin: true,
        },
        {
          id: "bmi-calc",
          name: "BMI Calculator",
          icon: "‚öñÔ∏è",
          category: "healthcare",
          url: "#",
          builtin: true,
        },
        {
          id: "appointment-scheduler",
          name: "Appointments",
          icon: "üìÖ",
          category: "healthcare",
          url: "#",
          builtin: true,
        },
        {
          id: "health-tracker",
          name: "Health Tracker",
          icon: "üíì",
          category: "healthcare",
          url: "#",
          builtin: true,
        },

        // Hospitality Industry Apps
        {
          id: "menu-planner",
          name: "Menu Planner",
          icon: "ÔøΩ",
          category: "hospitality",
          url: "#",
          builtin: true,
        },
        {
          id: "reservation-system",
          name: "Reservations",
          icon: "üí≥",
          category: "hospitality",
          url: "#",
          builtin: true,
        },
        {
          id: "table-manager",
          name: "Table Manager",
          icon: "üìä",
          category: "hospitality",
          url: "#",
          builtin: true,
        },
        {
          id: "order-tracker",
          name: "Order Tracker",
          icon: "ÔøΩ",
          category: "hospitality",
          url: "#",
          builtin: true,
        },
        {
          id: "tip-calculator",
          name: "Tip Calculator",
          icon: "üè∑Ô∏è",
          category: "hospitality",
          url: "#",
          builtin: true,
        },

        // Manufacturing Industry Apps
        {
          id: "production-tracker",
          name: "Production Track",
          icon: "üè≠",
          category: "manufacturing",
          url: "#",
          builtin: true,
        },
        {
          id: "quality-control",
          name: "Quality Control",
          icon: "‚úÖ",
          category: "manufacturing",
          url: "#",
          builtin: true,
        },
        {
          id: "equipment-log",
          name: "Equipment Log",
          icon: "‚öôÔ∏è",
          category: "manufacturing",
          url: "#",
          builtin: true,
        },
        {
          id: "shift-planner",
          name: "Shift Planner",
          icon: "‚è∞",
          category: "manufacturing",
          url: "#",
          builtin: true,
        },
        {
          id: "waste-tracker",
          name: "Waste Tracker",
          icon: "‚ôªÔ∏è",
          category: "manufacturing",
          url: "#",
          builtin: true,
        },

        // General Tools
        {
          id: "calc",
          name: "Calculator",
          icon: "üßÆ",
          category: "general",
          url: "apps/calculator.html",
          builtin: true,
        },
        {
          id: "todo",
          name: "Todo List",
          icon: "‚úÖ",
          category: "general",
          url: "apps/todo-list.html",
          builtin: true,
        },
        {
          id: "password",
          name: "Password Gen",
          icon: "üîê",
          category: "general",
          url: "apps/password-generator.html",
          builtin: true,
        },
        {
          id: "stopwatch",
          name: "Stopwatch",
          icon: "‚è≤Ô∏è",
          category: "general",
          url: "apps/stopwatch.html",
          builtin: true,
        },
        {
          id: "dice",
          name: "Dice Roller",
          icon: "üé≤",
          category: "general",
          url: "apps/dice-roller.html",
          builtin: true,
        },
      ];

      let apps = [...defaultApps];
      let customApps = JSON.parse(
        localStorage.getItem("miniapps-custom") || "[]"
      );
      apps = [...defaultApps, ...customApps];

      // Favorites system
      let favorites = JSON.parse(
        localStorage.getItem("miniapps-favorites") || "[]"
      );
      let showingFavoritesOnly = false;

      const container = document.getElementById("appsContainer");
      const grid = document.getElementById("appsGrid");
      let currentFilter = "all";
      let searchTerm = "";

      const emojis = [
        "üì±",
        "üíª",
        "üñ•Ô∏è",
        "‚åö",
        "üì∑",
        "üéÆ",
        "üïπÔ∏è",
        "üéµ",
        "üé¨",
        "üì∫",
        "üé®",
        "‚úèÔ∏è",
        "üìù",
        "üìä",
        "üìà",
        "üßÆ",
        "‚è∞",
        "‚è±Ô∏è",
        "‚è≤Ô∏è",
        "üìÖ",
        "üîß",
        "‚öôÔ∏è",
        "üî®",
        "üõ†Ô∏è",
        "‚öñÔ∏è",
        "üîç",
        "üîê",
        "üóùÔ∏è",
        "üîí",
        "üîì",
        "üí°",
        "üîã",
        "üì°",
        "üì∂",
        "üíæ",
        "üíø",
        "üìÄ",
        "üíΩ",
        "üñ®Ô∏è",
        "üì†",
        "‚òÅÔ∏è",
        "üåê",
        "üåç",
        "üó∫Ô∏è",
        "üß≠",
        "‚≠ê",
        "üåü",
        "‚ú®",
        "üí´",
        "üîÆ",
        "üéØ",
        "üèÜ",
        "ü•á",
        "üèÖ",
        "üéóÔ∏è",
        "üéñÔ∏è",
        "üèµÔ∏è",
        "üéÄ",
        "üéÅ",
        "üéä",
      ];

      // Sort apps by category for better organization
      const categoryOrder = [
        "business",
        "technology", 
        "wellness",
        "operations",
        "general",
      ];

      function createBubble(app, index) {
        const bubble = document.createElement("div");
        const isFavorited = favorites.includes(app.id);
        bubble.className = `app-bubble category-${app.category}${
          app.backgroundImage ? " has-image" : ""
        }${!app.builtin ? " custom" : ""}${isFavorited ? " favorited" : ""}`;
        bubble.dataset.category = app.category;
        bubble.dataset.appId = app.id;

        if (app.backgroundImage) {
          bubble.style.backgroundImage = `url(${app.backgroundImage})`;
        }

        const favoriteIcon = isFavorited ? "‚≠ê" : "‚òÜ";
        const favoriteClass = isFavorited ? "favorite active" : "favorite";

        const actionsHtml = !app.builtin
          ? `
          <div class="app-actions">
            <button class="app-action-btn ${favoriteClass}" onclick="toggleFavorite('${app.id}')" title="Toggle Favorite">${favoriteIcon}</button>
            <button class="app-action-btn delete" onclick="deleteApp('${app.id}')" title="Delete">üóëÔ∏è</button>
          </div>
        `
          : `
          <div class="app-actions">
            <button class="app-action-btn ${favoriteClass}" onclick="toggleFavorite('${app.id}')" title="Toggle Favorite">${favoriteIcon}</button>
          </div>
        `;

        bubble.innerHTML = `
          ${actionsHtml}
          <div class="favorites-indicator">‚≠ê</div>
          <div class="category-indicator ${app.category}"></div>
          <div class="app-icon">${app.icon}</div>
          <div class="app-name">${app.name}</div>
        `;

        // Add gentle floating animation with staggered delay
        bubble.style.animation = `gentleFloat ${
          6 + Math.random() * 2
        }s ease-in-out infinite`;
        bubble.style.animationDelay = `${index * 0.1 + Math.random() * 0.5}s`;

        bubble.addEventListener("click", (e) => {
          if (e.target.closest(".app-actions")) return;

          // Add click feedback
          bubble.style.transform = "scale(0.95)";
          setTimeout(() => {
            bubble.style.transform = "";
            if (app.url !== "#") {
              window.open(app.url, "_blank");
            } else {
              showNotification(`${app.name} - Coming Soon!`, "error");
            }
          }, 150);
        });

        return bubble;
      }

      function displayApps() {
        let filteredApps = apps;

        // Filter by work/fun mode first
        const availableCategories =
          currentMode === "work" ? workCategories : funCategories;
        filteredApps = apps.filter((app) =>
          availableCategories.includes(app.category)
        );

        // Filter by favorites
        if (showingFavoritesOnly) {
          filteredApps = filteredApps.filter((app) =>
            favorites.includes(app.id)
          );
        }

        // Filter by category
        if (currentFilter !== "all") {
          filteredApps = filteredApps.filter(
            (app) => app.category === currentFilter
          );
        }

        // Filter by search term
        if (searchTerm) {
          filteredApps = filteredApps.filter((app) =>
            app.name.toLowerCase().includes(searchTerm.toLowerCase())
          );
        }

        // Sort apps
        filteredApps.sort((a, b) => {
          const aIndex = categoryOrder.indexOf(a.category);
          const bIndex = categoryOrder.indexOf(b.category);
          if (aIndex === bIndex) {
            return a.name.localeCompare(b.name);
          }
          return aIndex - bIndex;
        });

        // Clear the grid
        grid.innerHTML = "";

        if (filteredApps.length === 0) {
          grid.innerHTML = `
            <div style="grid-column: 1 / -1; text-align: center; padding: 4rem 2rem; opacity: 0.7;">
              <h3>No apps found</h3>
              <p>Try adjusting your search or filters</p>
            </div>
          `;
          return;
        }

        // Create and add bubbles with staggered animation
        filteredApps.forEach((app, index) => {
          const bubble = createBubble(app, index);
          grid.appendChild(bubble);

          // Animate in with delay
          setTimeout(() => {
            bubble.classList.add("visible");
          }, index * 50);
        });
      }

      // App Management Functions
      function saveApps() {
        const customOnly = apps.filter((app) => !app.builtin);
        localStorage.setItem("miniapps-custom", JSON.stringify(customOnly));
      }

      function generateId() {
        return (
          "app_" + Date.now() + "_" + Math.random().toString(36).substr(2, 9)
        );
      }

      function showNotification(message, type = "success") {
        const notification = document.getElementById("notification");
        notification.textContent = message;
        notification.className = `notification ${type}`;
        notification.classList.add("show");

        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }

      // Favorites Functions
      function saveFavorites() {
        localStorage.setItem("miniapps-favorites", JSON.stringify(favorites));
      }

      function toggleFavorite(appId) {
        const index = favorites.indexOf(appId);
        if (index > -1) {
          favorites.splice(index, 1);
          showNotification("Removed from favorites", "success");
        } else {
          favorites.push(appId);
          showNotification("Added to favorites", "success");
        }
        saveFavorites();
        displayApps();
      }

      function toggleFavoritesView() {
        showingFavoritesOnly = !showingFavoritesOnly;
        const button = document.getElementById("favoritesToggle");

        if (showingFavoritesOnly) {
          button.textContent = "üìö Show All";
          button.classList.add("favorites-view-active");

          // Reset other filters when showing favorites
          currentFilter = "all";
          searchTerm = "";
          document.getElementById("searchBox").value = "";
          document.querySelectorAll(".filter-btn").forEach((btn) => {
            btn.classList.remove("active");
            if (btn.dataset.filter === "all") {
              btn.classList.add("active");
            }
          });

          showNotification(
            `Showing ${favorites.length} favorite apps`,
            "success"
          );
        } else {
          button.textContent = "‚≠ê My Favorites";
          button.classList.remove("favorites-view-active");
          showNotification("Showing all apps", "success");
        }

        displayApps();
      }

      function deleteApp(id) {
        const app = apps.find((a) => a.id === id);
        if (!app || app.builtin) return;

        if (confirm(`Delete "${app.name}"?`)) {
          apps = apps.filter((a) => a.id !== id);
          // Also remove from favorites if it was favorited
          const favIndex = favorites.indexOf(id);
          if (favIndex > -1) {
            favorites.splice(favIndex, 1);
            saveFavorites();
          }
          saveApps();
          displayApps();
          showNotification("App deleted successfully");
        }
      }

      // Search functionality
      document.getElementById("searchBox").addEventListener("input", (e) => {
        searchTerm = e.target.value.trim();
        displayApps();
      });

      // Filter functionality
      document.querySelectorAll(".filter-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          // Update active button
          document
            .querySelectorAll(".filter-btn")
            .forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");

          // Update filter and refresh display
          currentFilter = btn.dataset.filter;

          // Add transition effect
          const bubbles = document.querySelectorAll(".app-bubble");
          bubbles.forEach((bubble, index) => {
            bubble.style.transition = "all 0.3s ease";
            bubble.style.transform = "translateY(20px) scale(0.8)";
            bubble.style.opacity = "0";
          });

          setTimeout(() => {
            displayApps();
          }, 300);
        });
      });

      // Keyboard shortcuts
      document.addEventListener("keydown", (e) => {
        if (e.ctrlKey || e.metaKey) {
          if (e.key === "f") {
            e.preventDefault();
            toggleFavoritesView();
          }
        }
      });

      // Responsive handling
      window.addEventListener("resize", () => {
        // Small delay to ensure proper recalculation
        setTimeout(displayApps, 100);
      });

      // Work/Fun Mode Functions
      let currentMode = "work";
      const workCategories = [
        "business",
        "technology",
        "wellness", 
        "operations",
      ];
      const funCategories = ["general"]; // We'll add more fun categories later

      function toggleMode(mode) {
        currentMode = mode;

        // Update corner toggle states
        document
          .getElementById("workToggle")
          .classList.toggle("active", mode === "work");
        document
          .getElementById("funToggle")
          .classList.toggle("active", mode === "fun");

        // Update body class for background
        document.body.classList.toggle("fun-mode", mode === "fun");

        // Filter apps based on mode
        const availableCategories =
          mode === "work" ? workCategories : funCategories;

        // Reset filters when switching modes
        currentFilter = "all";
        searchTerm = "";
        showingFavoritesOnly = false;

        // Update UI
        document.getElementById("searchBox").value = "";
        document.getElementById("favoritesToggle").textContent =
          "‚≠ê My Favorites";
        document
          .getElementById("favoritesToggle")
          .classList.remove("favorites-view-active");

        // Update filter buttons
        updateFilterButtons(availableCategories);

        displayApps();

        showNotification(`Switched to ${mode.toUpperCase()} mode`, "success");
      }

      function updateFilterButtons(availableCategories) {
        const filterContainer = document.querySelector(".filter-container");
        const allBtn =
          '<button class="filter-btn active" data-filter="all">All</button>';

        if (currentMode === "work") {
          filterContainer.innerHTML =
            allBtn +
            `
            <button class="filter-btn" data-filter="finance">üí∞ Finance</button>
            <button class="filter-btn" data-filter="technology">üíª Technology</button>
            <button class="filter-btn" data-filter="education">üéì Education</button>
            <button class="filter-btn" data-filter="construction">üèóÔ∏è Construction</button>
            <button class="filter-btn" data-filter="transport">üöö Transport</button>
            <button class="filter-btn" data-filter="healthcare">üè• Healthcare</button>
            <button class="filter-btn" data-filter="hospitality">üçΩÔ∏è Hospitality</button>
            <button class="filter-btn" data-filter="manufacturing">üè≠ Manufacturing</button>
          `;
        } else {
          filterContainer.innerHTML =
            allBtn +
            `
            <button class="filter-btn" data-filter="games">üéÆ Games</button>
            <button class="filter-btn" data-filter="entertainment">üé¨ Entertainment</button>
            <button class="filter-btn" data-filter="social">üí¨ Social</button>
            <button class="filter-btn" data-filter="creative">üé® Creative</button>
            <button class="filter-btn" data-filter="general">üîß General</button>
          `;
        }

        // Re-attach event listeners
        document.querySelectorAll(".filter-btn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document
              .querySelectorAll(".filter-btn")
              .forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            currentFilter = btn.dataset.filter;

            const bubbles = document.querySelectorAll(".app-bubble");
            bubbles.forEach((bubble, index) => {
              bubble.style.transition = "all 0.3s ease";
              bubble.style.transform = "translateY(20px) scale(0.8)";
              bubble.style.opacity = "0";
            });

            setTimeout(() => {
              displayApps();
            }, 300);
          });
        });
      }

      // Initialize the app
      displayApps();
    </script>
  </body>
</html>
